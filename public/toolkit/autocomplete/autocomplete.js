!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@spiral-toolkit/core")):"function"==typeof define&&define.amd?define("@spiral-toolkit/autocomplete",["@spiral-toolkit/core"],e):"object"==typeof exports?exports["@spiral-toolkit/autocomplete"]=e(require("@spiral-toolkit/core")):t.SFAutocomplete=e(t.SFToolkit)}(window,(function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=3)}([function(e,n){e.exports=t},function(t,e,n){"use strict";(function(e){var r=n(5);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function o(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0}function i(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var s=n(6),a=Object.prototype.hasOwnProperty,u=Array.prototype.slice,c="foo"===function(){}.name;function l(t){return Object.prototype.toString.call(t)}function p(t){return!i(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var d=t.exports=v,f=/\s*function\s+([^\(\s]*)\s*/;function h(t){if(s.isFunction(t)){if(c)return t.name;var e=t.toString().match(f);return e&&e[1]}}function y(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function m(t){if(c||!s.isFunction(t))return s.inspect(t);var e=h(t);return"[Function"+(e?": "+e:"")+"]"}function g(t,e,n,r,o){throw new d.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:o})}function v(t,e){t||g(t,!0,e,"==",d.ok)}function b(t,e,n,r){if(t===e)return!0;if(i(t)&&i(e))return 0===o(t,e);if(s.isDate(t)&&s.isDate(e))return t.getTime()===e.getTime();if(s.isRegExp(t)&&s.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(p(t)&&p(e)&&l(t)===l(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===o(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(i(t)!==i(e))return!1;var a=(r=r||{actual:[],expected:[]}).actual.indexOf(t);return-1!==a&&a===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(s.isPrimitive(t)||s.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var o=I(t),i=I(e);if(o&&!i||!o&&i)return!1;if(o)return t=u.call(t),e=u.call(e),b(t,e,n);var a,c,l=D(t),p=D(e);if(l.length!==p.length)return!1;for(l.sort(),p.sort(),c=l.length-1;c>=0;c--)if(l[c]!==p[c])return!1;for(c=l.length-1;c>=0;c--)if(a=l[c],!b(t[a],e[a],n,r))return!1;return!0}(t,e,n,r))}return n?t===e:t==e}function I(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function w(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function x(t,e,n,r){var o;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),o=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!o&&g(o,n,"Missing expected exception"+r);var i="string"==typeof r,a=!t&&o&&!n;if((!t&&s.isError(o)&&i&&w(o,n)||a)&&g(o,n,"Got unwanted exception"+r),t&&o&&n&&!w(o,n)||!t&&o)throw o}d.AssertionError=function(t){var e;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=y(m((e=this).actual),128)+" "+e.operator+" "+y(m(e.expected),128),this.generatedMessage=!0);var n=t.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,n);else{var r=new Error;if(r.stack){var o=r.stack,i=h(n),s=o.indexOf("\n"+i);if(s>=0){var a=o.indexOf("\n",s+1);o=o.substring(a+1)}this.stack=o}}},s.inherits(d.AssertionError,Error),d.fail=g,d.ok=v,d.equal=function(t,e,n){t!=e&&g(t,e,n,"==",d.equal)},d.notEqual=function(t,e,n){t==e&&g(t,e,n,"!=",d.notEqual)},d.deepEqual=function(t,e,n){b(t,e,!1)||g(t,e,n,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(t,e,n){b(t,e,!0)||g(t,e,n,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(t,e,n){b(t,e,!1)&&g(t,e,n,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=function t(e,n,r){b(e,n,!0)&&g(e,n,r,"notDeepStrictEqual",t)},d.strictEqual=function(t,e,n){t!==e&&g(t,e,n,"===",d.strictEqual)},d.notStrictEqual=function(t,e,n){t===e&&g(t,e,n,"!==",d.notStrictEqual)},d.throws=function(t,e,n){x(!0,t,e,n)},d.doesNotThrow=function(t,e,n){x(!1,t,e,n)},d.ifError=function(t){if(t)throw t},d.strict=r((function t(e,n){e||g(e,!0,n,"==",t)}),d,{equal:d.strictEqual,deepEqual:d.deepStrictEqual,notEqual:d.notStrictEqual,notDeepEqual:d.notDeepStrictEqual}),d.strict.strict=d.strict;var D=Object.keys||function(t){var e=[];for(var n in t)a.call(t,n)&&e.push(n);return e}}).call(this,n(4))},function(t,e,n){"use strict";const r=n(10),o=n(11),i=n(12);function s(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function a(t,e){return e.encode?e.strict?r(t):encodeURIComponent(t):t}function u(t,e){return e.decode?o(t):t}function c(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function l(t){const e=(t=c(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function p(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?t=Number(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()||(t="true"===t.toLowerCase()),t}function d(t,e){s((e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e)).arrayFormatSeparator);const n=function(t){let e;switch(t.arrayFormat){case"index":return(t,n,r)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===r[t]&&(r[t]={}),r[t][e[1]]=n):r[t]=n};case"bracket":return(t,n,r)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==r[t]?r[t]=[].concat(r[t],n):r[t]=[n]:r[t]=n};case"comma":case"separator":return(e,n,r)=>{const o="string"==typeof n&&n.split("").indexOf(t.arrayFormatSeparator)>-1?n.split(t.arrayFormatSeparator).map(e=>u(e,t)):null===n?n:u(n,t);r[e]=o};default:return(t,e,n)=>{void 0!==n[t]?n[t]=[].concat(n[t],e):n[t]=e}}}(e),r=Object.create(null);if("string"!=typeof t)return r;if(!(t=t.trim().replace(/^[?#&]/,"")))return r;for(const o of t.split("&")){let[t,s]=i(e.decode?o.replace(/\+/g," "):o,"=");s=void 0===s?null:["comma","separator"].includes(e.arrayFormat)?s:u(s,e),n(u(t,e),s,r)}for(const t of Object.keys(r)){const n=r[t];if("object"==typeof n&&null!==n)for(const t of Object.keys(n))n[t]=p(n[t],e);else r[t]=p(n,e)}return!1===e.sort?r:(!0===e.sort?Object.keys(r).sort():Object.keys(r).sort(e.sort)).reduce((t,e)=>{const n=r[e];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?t[e]=function t(e){return Array.isArray(e)?e.sort():"object"==typeof e?t(Object.keys(e)).sort((t,e)=>Number(t)-Number(e)).map(t=>e[t]):e}(n):t[e]=n,t},Object.create(null))}e.extract=l,e.parse=d,e.stringify=(t,e)=>{if(!t)return"";s((e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e)).arrayFormatSeparator);const n=n=>e.skipNull&&null==t[n]||e.skipEmptyString&&""===t[n],r=function(t){switch(t.arrayFormat){case"index":return e=>(n,r)=>{const o=n.length;return void 0===r||t.skipNull&&null===r||t.skipEmptyString&&""===r?n:null===r?[...n,[a(e,t),"[",o,"]"].join("")]:[...n,[a(e,t),"[",a(o,t),"]=",a(r,t)].join("")]};case"bracket":return e=>(n,r)=>void 0===r||t.skipNull&&null===r||t.skipEmptyString&&""===r?n:null===r?[...n,[a(e,t),"[]"].join("")]:[...n,[a(e,t),"[]=",a(r,t)].join("")];case"comma":case"separator":return e=>(n,r)=>null==r||0===r.length?n:0===n.length?[[a(e,t),"=",a(r,t)].join("")]:[[n,a(r,t)].join(t.arrayFormatSeparator)];default:return e=>(n,r)=>void 0===r||t.skipNull&&null===r||t.skipEmptyString&&""===r?n:null===r?[...n,a(e,t)]:[...n,[a(e,t),"=",a(r,t)].join("")]}}(e),o={};for(const e of Object.keys(t))n(e)||(o[e]=t[e]);const i=Object.keys(o);return!1!==e.sort&&i.sort(e.sort),i.map(n=>{const o=t[n];return void 0===o?"":null===o?a(n,e):Array.isArray(o)?o.reduce(r(n),[]).join("&"):a(n,e)+"="+a(o,e)}).filter(t=>t.length>0).join("&")},e.parseUrl=(t,e)=>({url:c(t).split("?")[0]||"",query:d(l(t),e)}),e.stringifyUrl=(t,n)=>{const r=c(t.url).split("?")[0]||"",o=e.extract(t.url),i=e.parse(o),s=function(t){let e="";const n=t.indexOf("#");return-1!==n&&(e=t.slice(n)),e}(t.url),a=Object.assign(i,t.query);let u=e.stringify(a,n);return u&&(u="?"+u),`${r}${u}${s}`}},function(t,e,n){t.exports=n(13)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function s(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,u=s(t),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))o.call(n,l)&&(u[l]=n[l]);if(r){a=r(n);for(var p=0;p<a.length;p++)i.call(n,a[p])&&(u[a[p]]=n[a[p]])}}return u}},function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},o=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),u=r[n];n<i;u=r[++n])y(u)||!I(u)?s+=" "+u:s+=" "+a(u);return s},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,s={};function a(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(n)?r.showHidden=n:n&&e._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,t,r.depth)}function u(t,e){var n=a.styles[e];return n?"["+a.colors[n][0]+"m"+t+"["+a.colors[n][1]+"m":t}function c(t,e){return t}function l(t,n,r){if(t.customInspect&&n&&D(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return g(o)||(o=l(t,o,r)),o}var i=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(m(e))return t.stylize(""+e,"number");if(h(e))return t.stylize(""+e,"boolean");if(y(e))return t.stylize("null","null")}(t,n);if(i)return i;var s=Object.keys(n),a=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),x(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return p(n);if(0===s.length){if(D(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(x(n))return p(n)}var c,I="",E=!1,O=["{","}"];(f(n)&&(E=!0,O=["[","]"]),D(n))&&(I=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(I=" "+RegExp.prototype.toString.call(n)),w(n)&&(I=" "+Date.prototype.toUTCString.call(n)),x(n)&&(I=" "+p(n)),0!==s.length||E&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=E?function(t,e,n,r,o){for(var i=[],s=0,a=e.length;s<a;++s)T(e,String(s))?i.push(d(t,e,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(t,e,n,r,o,!0))})),i}(t,n,r,a,s):s.map((function(e){return d(t,n,r,a,e,E)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,I,O)):O[0]+I+O[1]}function p(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,n,r,o,i){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),T(r,o)||(s="["+o+"]"),a||(t.seen.indexOf(u.value)<0?(a=y(n)?l(t,u.value,null):l(t,u.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),v(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function f(t){return Array.isArray(t)}function h(t){return"boolean"==typeof t}function y(t){return null===t}function m(t){return"number"==typeof t}function g(t){return"string"==typeof t}function v(t){return void 0===t}function b(t){return I(t)&&"[object RegExp]"===E(t)}function I(t){return"object"==typeof t&&null!==t}function w(t){return I(t)&&"[object Date]"===E(t)}function x(t){return I(t)&&("[object Error]"===E(t)||t instanceof Error)}function D(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function O(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(v(i)&&(i=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(i)){var r=t.pid;s[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else s[n]=function(){};return s[n]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=h,e.isNull=y,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=b,e.isObject=I,e.isDate=w,e.isError=x,e.isFunction=D,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(8);var j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),j[t.getMonth()],e].join(" ")}function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",S(),e.format.apply(e,arguments))},e.inherits=n(9),e._extend=function(t,e){if(!e||!I(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var k="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function R(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(k&&t[k]){var e;if("function"!=typeof(e=t[k]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,k,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,o)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),k&&Object.defineProperty(e,k,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=k,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var o=n.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,s=function(){return o.apply(i,arguments)};e.apply(this,n).then((function(e){t.nextTick(s,null,e)}),(function(e){t.nextTick(R,e,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(7))},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],l=!1,p=-1;function d(){l&&u&&(l=!1,u.length?c=u.concat(c):p=-1,c.length&&f())}function f(){if(!l){var t=a(d);l=!0;for(var e=c.length;e;){for(u=c,c=[];++p<e;)u&&u[p].run();p=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function y(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new h(t,e)),1!==c.length||l||a(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";t.exports=t=>encodeURIComponent(t).replace(/[!'()*]/g,t=>"%"+t.charCodeAt(0).toString(16).toUpperCase())},function(t,e,n){"use strict";var r=new RegExp("%[a-f0-9]{2}","gi"),o=new RegExp("(%[a-f0-9]{2})+","gi");function i(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var n=t.slice(0,e),r=t.slice(e);return Array.prototype.concat.call([],i(n),i(r))}function s(t){try{return decodeURIComponent(t)}catch(o){for(var e=t.match(r),n=1;n<e.length;n++)e=(t=i(e,n).join("")).match(r);return t}}t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},n=o.exec(t);n;){try{e[n[0]]=decodeURIComponent(n[0])}catch(t){var r=s(n[0]);r!==n[0]&&(e[n[0]]=r)}n=o.exec(t)}e["%C2"]="�";for(var i=Object.keys(e),a=0;a<i.length;a++){var u=i[a];t=t.replace(new RegExp(u,"g"),e[u])}return t}(t)}}},function(t,e,n){"use strict";t.exports=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const n=t.indexOf(e);return-1===n?[t]:[t.slice(0,n),t.slice(n+e.length)]}},function(t,e,n){"use strict";n.r(e),n.d(e,"version",(function(){return O}));var r=n(0),o=n.n(r),i=n(1),s=n.n(i);function a(t,e,n){var r=n.value;if("function"!=typeof r)throw new TypeError("@boundMethod decorator can only be applied to methods not: "+typeof r);var o=!1;return{configurable:!0,get:function(){if(o||this===t.prototype||this.hasOwnProperty(e)||"function"!=typeof r)return r;var n=r.bind(this);return o=!0,Object.defineProperty(this,e,{configurable:!0,get:function(){return n},set:function(t){r=t,delete this[e]}}),o=!1,n},set:function(t){r=t}}}function u(t,e){if(!e)return"";var n=t[e];return n?""+n:""}function c(t,e,n){var r;return void 0===e&&(e=50),void 0===n&&(n={isImmediate:!1}),function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var s=this,a=function(){r=void 0,n.isImmediate||t.apply(s,o)},u=n.isImmediate&&void 0===r;void 0!==r&&clearTimeout(r),r=setTimeout(a,e),u&&t.apply(s,o)}}var l=n(2);var p,d=function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},f=function(){function t(t){this.options=t,this.isDynamic=!!this.options.url}return t.prototype.getData=function(t){this.isDynamic?this.getResultsByURL(t):this.getResultsFromData(t)},t.prototype.restoreDataItem=function(t){this.isDynamic?this.restoreDataItemByUrl(t):this.restoreDataItemFromData(t)},t.prototype.restoreDataItemFromData=function(t){var e=[];this.options.data.forEach((function(n){var r,o="";"string"!=typeof n?(r=n.id,o=n.name):(r=n,o=n),t.includes(r)&&e.push({id:r,name:o})})),this.handleRestoreSuccess(t,e)},t.prototype.restoreDataItemByUrl=function(t){var e,n=this,r=this.options.valueKey;o.a.ajax.send(this.getRequestParams({paginate:{limit:t.length},filter:(e={},e[r]=t,e)})).then((function(e){var o=e.data[n.options.dataField||"data"].map((function(t){var e;return d(d({},t),((e={})[r]=t[r].toString(),e))})).slice(0,t.length);n.handleRestoreSuccess(t,o)})).catch((function(t){console.error(t)}))},t.prototype.handleRestoreSuccess=function(t,e){var n=this.options.valueKey,r={};e.forEach((function(t){r[u(t,n)]=t}));var o=t.map((function(t){return r[t]||console.warn("Could not recover autocomplete element with id ",t),r[t]})).filter((function(t){return!!t}));this.options.onRestoreDataItem(o)},t.prototype.handleSuccessResponse=function(t,e){this.lastSearchKeyword===t&&this.options.onSuccessResponse(t,e)},t.prototype.handleErrorResponse=function(t){this.lastSearchKeyword===t&&this.options.onErrorResponse(t)},t.prototype.getResultsFromData=function(t){var e=t.toLocaleLowerCase();this.lastSearchKeyword=t;var n=[];this.options.data.forEach((function(t){var r,o="";"string"!=typeof t?(r=t.id,o=t.name):(r=t,o=t),o.toLocaleLowerCase().startsWith(e)&&n.push({id:r,name:o})})),this.handleSuccessResponse(t,n)},t.prototype.getResultsByURL=function(t){var e=this,n=this.options.valueKey;this.lastSearchKeyword=t,o.a.ajax.send(this.getRequestParams({paginate:{limit:10},filter:{search:t}})).then((function(r){var o=r.data[e.options.dataField||"data"].map((function(t){var e;return d(d({},t),((e={})[n]=t[n].toString(),e))})).slice(0,10);e.handleSuccessResponse(t,o)})).catch((function(){e.handleErrorResponse(t)}))},t.prototype.getRequestParams=function(t){var e=this.options,n=e.method,r=e.headers,o=e.url,i=(n||"GET").toUpperCase(),s={method:i,headers:r||{"Content-Type":"application/json",Accept:"application/json"},url:o,data:void 0};return"GET"===i?s.url=function(t,e){var n={};return e.fetchCount&&(n.fetchCount=!0),e.filter&&Object.keys(e.filter).forEach((function(t){n["filter["+t+"]"]=e.filter[t]})),e.paginate&&Object.keys(e.paginate).forEach((function(t){n["paginate["+t+"]"]=e.paginate[t]})),e.sort&&Object.keys(e.sort).forEach((function(t){n["sort["+t+"]"]=e.sort[t]})),Object(l.stringifyUrl)({url:t,query:n},{arrayFormat:"bracket"})}(o,t):s.data=t,s},t}(),h=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},y=function(){function t(t){this.items=[],this.node=document.createElement("div"),this.node.classList.add("sf-autocomplete__dropdown","dropdown-menu"),this.options=t,this.selectedIndex=-1,this.isDisabled=this.options.isDisabled,this.prependLoadingElem(),this.isLoading=!1}return t.prototype.prependLoadingElem=function(){var t=document.createElement("div");t.classList.add("dropdown-item"),t.innerHTML=this.options.loadingTemplate||'<span class="sf-autocomplete__loader">Loading...</span>',t.style.display="none",this.node.insertBefore(t,this.node.firstChild),this.loadingElem=t},t.prototype.appendNoResults=function(){var t=document.createElement("div");t.classList.add("dropdown-item"),t.innerHTML='<span class="sf-autocomplete__noresults">No results</span>',this.node.appendChild(t)},t.prototype.show=function(){this.isDisabled||this.node.classList.add("show")},t.prototype.hide=function(){return!!this.node.classList.contains("show")&&(this.node.classList.remove("show"),this.clearIndex(),!0)},t.prototype.clear=function(){var t=this.node.cloneNode(!1);this.node.parentNode.replaceChild(t,this.node),this.node=t,this.prependLoadingElem()},t.prototype.enable=function(){this.isDisabled=!1},t.prototype.disable=function(){this.isDisabled=!0},t.prototype.toggleLoading=function(t){this.isDisabled||this.isLoading!==t&&(this.isLoading=t,this.loadingElem&&(this.loadingElem.style.display=t?"block":"none"))},t.prototype.setData=function(t){this.data=t,this.clear(),this.render()},t.prototype.setNoResults=function(){this.clear(),this.appendNoResults()},t.prototype.suggest=function(t){var e=this;if(this.data&&t){var n=this.data.findIndex((function(n){return t===e.options.inputTemplate(n)}));if(-1!==n)return this.selectedIndex=n,this.redrawItems(),this.options.onSelectItem(this.data[n],!0),!0}return!1},t.prototype.render=function(){var t=this;if(this.data&&this.data.length){this.items=this.data.map((function(e,n){return t.renderItem(n,e)}));var e=document.createDocumentFragment();this.items.forEach((function(t){return e.appendChild(t)})),this.node.appendChild(e)}},t.prototype.redrawItems=function(){var t=this;this.items.forEach((function(e,n){return e.classList.toggle("active",n===t.selectedIndex)}))},t.prototype.renderItem=function(t,e){var n=document.createElement("div");return n.classList.add("dropdown-item","js-sf-dropdown-item"),n.tabIndex=0,n.dataset.index=t.toString(),n.innerHTML=this.options.suggestTemplate(e),n.addEventListener("click",this.handleClickItem),n.addEventListener("focus",this.handleFocusItem),n.addEventListener("keydown",this.handleKeyDownItem),n},t.prototype.focusSelectedItem=function(){var t;-1!==this.selectedIndex&&(this.isInnerFocus=!0,null===(t=this.items[this.selectedIndex])||void 0===t||t.focus())},t.prototype.selectIndex=function(t){var e,n=null===(e=this.data)||void 0===e?void 0:e.length;n&&(this.selectedIndex=t>n||t<0?n-1:t,this.redrawItems(),-1!==this.selectedIndex&&(this.focusSelectedItem(),this.options.onSelectItem(this.data[this.selectedIndex])))},t.prototype.clearIndex=function(){this.selectedIndex=-1,this.redrawItems()},t.prototype.handleClickItem=function(t){var e=t.target;if(e.classList.contains("js-sf-dropdown-item")||(e=e.closest(".js-sf-dropdown-item")),e){var n=e.dataset.index;this.selectedIndex=void 0===n?-1:parseInt(n,10),this.redrawItems(),this.isInnerFocus=!0,this.focusSelectedItem(),this.options.onSelectItem(this.data[this.selectedIndex],!0),this.hide()}},t.prototype.handleFocusItem=function(t){if(this.isInnerFocus)this.isInnerFocus=!1;else{var e=t.target.dataset.index;this.selectedIndex=void 0===e?-1:parseInt(e,10),this.redrawItems(),this.options.onSelectItem(this.data[this.selectedIndex])}},t.prototype.handleKeyDownItem=function(t){var e=this.items.length;if(e)return"ArrowUp"===t.key?(t.preventDefault(),0===this.selectedIndex?(this.clearIndex(),void this.options.onBlur()):void this.selectIndex(this.selectedIndex-1)):"ArrowDown"===t.key?(t.preventDefault(),this.selectedIndex===e-1?(this.clearIndex(),void this.options.onBlur()):void this.selectIndex(this.selectedIndex+1)):"Enter"===t.key?(t.preventDefault(),this.options.onSelectItem(this.data[this.selectedIndex],!0),void this.hide()):void("Escape"===t.key&&(t.preventDefault(),this.clearIndex(),this.hide(),this.options.onBlur()))},h([a],t.prototype,"handleClickItem",null),h([a],t.prototype,"handleFocusItem",null),h([a],t.prototype,"handleKeyDownItem",null),t}(),m=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},g=function(){function t(t){this.options=t,this.data=[],this.items=[],this.parentNode=this.options.inputNode.parentNode,this.isDisabled=this.options.isDisabled}return t.prototype.appendTag=function(t){this.parentNode.insertBefore(t,this.options.inputNode)},t.prototype.enable=function(){this.isDisabled&&(this.isDisabled=!1,this.renderTags())},t.prototype.disable=function(){this.isDisabled||(this.isDisabled=!0,this.renderTags())},t.prototype.addTag=function(t){this.data.push(t);var e=this.renderTag(t);this.appendTag(e),this.items.push(e)},t.prototype.removeTag=function(t){var e=this.options.valueKey,n=u(t,e),r=this.data.findIndex((function(t){return u(t,e)===n}));if(-1!==r){var o=this.items[r];this.parentNode.removeChild(o),this.data.splice(r,1),this.items.splice(r,1)}},t.prototype.setTags=function(t){this.data=t.slice(),this.renderTags()},t.prototype.clearTags=function(){var t=this;this.items.forEach((function(e){return t.parentNode.removeChild(e)}))},t.prototype.renderTags=function(){var t=this;this.clearTags(),this.items=this.data.map((function(e){return t.renderTag(e)}));var e=document.createDocumentFragment();this.items.forEach((function(t){return e.appendChild(t)})),this.appendTag(e)},t.prototype.renderTag=function(t){var e=this.options.valueKey,n=document.createElement("div");n.classList.add("badge","badge-primary","sf-tag");var r=document.createElement("span");if(r.innerHTML=this.options.inputTemplate(t),n.appendChild(r),!this.isDisabled){var o=document.createElement("button");o.type="button",o.setAttribute("aria-label","Close"),o.classList.add("close"),o.innerHTML='<span aria-hidden="true">×</span>',o.dataset.value=u(t,e),n.appendChild(o),o.addEventListener("click",this.handleRemoveTag)}return n},t.prototype.handleRemoveTag=function(t){if(!this.isDisabled){t.preventDefault();var e=t.target.dataset.value;if(void 0!==e){var n=this.options.valueKey,r=this.data.find((function(t){return u(t,n)===e}));r&&(this.removeTag(r),this.options.onRemoveTag(r))}}},m([a],t.prototype,"handleRemoveTag",null),t}(),v=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),b=function(){return(b=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},I=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},w=o.a.constants,x=w.CUSTOM_INPUT_ATTR,D=w.CUSTOM_INPUT_TARGET_ATTR,E=function(t){function e(n,r,o){var i,a=t.call(this)||this;a.name=e.spiralFrameworkName,a.optionsToGrab={id:{value:e.defaultOptions.id,domAttr:"id"},name:{value:e.defaultOptions.name,domAttr:"data-name"},url:{value:e.defaultOptions.url,domAttr:"data-url"},preserveId:{value:e.defaultOptions.preserveId,domAttr:"data-preserve-id"}},a.options=b({},e.defaultOptions),s.a.ok(r.hasAttribute(x),"Node has custom form attribute"),s.a.ok(r.querySelector('input[data-sf="autocomplete-input"]'),"Node has input for inputting text"),s.a.ok(r.querySelector('div[data-sf="autocomplete-input-wrapper"]'),"Node has input wrapper"),s.a.ok(!(null===(i=r.querySelector('input[data-sf="autocomplete-input"]'))||void 0===i?void 0:i.getAttribute("name")),"Node has input for inputting text without name"),s.a.ok(r.querySelector("input["+D+"]"),"Node has input to serialize values"),a.textInput=r.querySelector('input[data-sf="autocomplete-input"]'),a.textInput.setAttribute("autocomplete","please-no-"+Date.now()),a.textInput.removeAttribute("readonly"),a.textInputWrapper=r.querySelector('div[data-sf="autocomplete-input-wrapper"]'),a.hiddenInput=r.querySelector("input["+D+"]"),a.init(n,r,o,e.defaultOptions),a.options.exposeLabelAs&&(a.textInput.setAttribute(D,"true"),a.textInput.name=a.options.exposeLabelAs),a.options.exposeLabelRequired&&a.textInput.setAttribute("required","true"),a.isDisabled=a.textInput.disabled,a.initDataSource(),a.initTemplates(),a.initDropdown(),a.initTags(),a.restoreValue(),a.observer=new MutationObserver((function(t){t.forEach(a.handleMutation)}));var u=a.options.debounce||0;return a.debouncedKeyDownListener=c(a.handleKeyDown,u),a.debouncedInputListener=c(a.handleInput,u),a.bind(),a}return v(e,t),e.prototype.initDataSource=function(){var t=this.options,e=t.data,n=t.valueKey,r=t.url,o=t.dataField,i=t.method,a=t.headers;s.a.ok(e||r,"Data or URL provided"),this.dataSource=new f({data:e,url:r,valueKey:n,dataField:o,method:i,headers:a,onRestoreDataItem:this.handleRestoreDataItem,onSuccessResponse:this.handleSuccessDataSourceResponse,onErrorResponse:this.handleErrorDataSourceResponse})},e.prototype.initTemplates=function(){var t=this.options,e=t.searchKey,n=t.suggestTemplate,r=t.inputTemplate,i=t.loadingTemplate;this.suggestTemplate=o.a.helpers.template.compile(n||"{{"+e+"}}"),this.inputTemplate=o.a.helpers.template.compile(r||"{{{"+e+"}}}"),this.loadingTemplate=i},e.prototype.initDropdown=function(){this.node.classList.contains("dropdown")||(this.dropdown=new y({isDisabled:this.isDisabled,suggestTemplate:this.suggestTemplate,inputTemplate:this.inputTemplate,loadingTemplate:this.loadingTemplate,onSelectItem:this.handleSelectDropdownItem,onBlur:this.handleBlurDropdown}),this.node.classList.add("dropdown"),this.node.appendChild(this.dropdown.node))},e.prototype.initTags=function(){this.options.isMultiple&&(this.tags=new g({isDisabled:this.isDisabled,inputNode:this.textInput,valueKey:this.options.valueKey,inputTemplate:this.inputTemplate,onRemoveTag:this.handleRemoveTag}),this.currentDataItems=[])},e.prototype.changeHiddenInput=function(t){this.hiddenInput.value!==t&&(this.hiddenInput.value=t,this.hiddenInput.dispatchEvent(new Event("change",{bubbles:!0})))},e.prototype.setDataItem=function(t,e){var n=u(t,this.options.valueKey);this.textInput.value=this.inputTemplate(t),this.changeHiddenInput(n),e&&(this.currentDataItem=t)},e.prototype.clearDataItem=function(){this.currentDataItem=void 0,this.textInput.value=this.currentTextValue||"",this.changeHiddenInput("")},e.prototype.resetDataItem=function(){this.currentDataItem?this.setDataItem(this.currentDataItem):this.clearDataItem()},e.prototype.focusInput=function(){this.options.isMultiple||this.resetDataItem(),this.isInnerFocus=!0,this.textInput.focus()},e.prototype.clearSuggestions=function(){this.dropdown.setData([])},e.prototype.getSuggestions=function(t){this.dataSource&&(this.dropdown.show(),this.dropdown.toggleLoading(!0),this.dataSource.getData(t))},e.prototype.resetHiddenInputValue=function(){if(this.options.isMultiple){var t=this.options,e=t.valueKey,n=t.separator,r=this.currentDataItems.map((function(t){return u(t,e)}));this.changeHiddenInput(r.filter((function(t){return""!==t})).join(n))}},e.prototype.handleSuccessDataSourceResponse=function(t,e){this.dropdown.toggleLoading(!1),e.length?(this.dropdown.show(),this.dropdown.setData(e),this.dropdown.suggest(t)):this.options.preserveId?this.dropdown.hide():(this.clearSuggestions(),this.clearDataItem(),this.dropdown.setNoResults())},e.prototype.handleErrorDataSourceResponse=function(){this.dropdown.toggleLoading(!1),this.dropdown.hide()},e.prototype.handleRestoreDataItem=function(t){if(this.dropdown.toggleLoading(!1),t&&t.length)if(this.options.isMultiple)this.tags.setTags(t),this.currentDataItems=t.slice();else{var e=t[0];this.setDataItem(e,!0),this.currentTextValue=this.textInput.value,this.dropdown.setData([e])}else this.changeHiddenInput("")},e.prototype.setDataItems=function(t){this.handleRestoreDataItem(t||[]),this.resetHiddenInputValue()},e.prototype.restoreValue=function(){var t,e=this.hiddenInput.value,n=this.textInput.value;if(this.options.initialDataItems&&this.handleRestoreDataItem(this.options.initialDataItems),!this.options.isMultiple&&e&&n){var r=((t={})[this.options.valueKey]=e,t[this.options.searchKey]=n,t);this.handleRestoreDataItem([r])}else this.setExternalValue(e)},e.prototype.setExternalValue=function(t){if(this.dataSource){if(this.hiddenInput.value=null!=t?t:"",this.clearSuggestions(),t){var e=this.options,n=e.isMultiple,r=e.separator,o=[];n?o=t.split(r):o.push(t),this.dataSource.restoreDataItem(o)}}else this.hiddenInput.value=""},e.prototype.handleFocus=function(){this.textInputWrapper.classList.add("focus"),this.isInnerFocus?this.isInnerFocus=!1:this.options.isMultiple||(this.resetDataItem(),this.textInput.value&&(this.dropdown.suggest(this.textInput.value)||this.clearDataItem(),this.dropdown.show()))},e.prototype.handleBlur=function(){this.textInputWrapper.classList.remove("focus")},e.prototype.handleKeyDown=function(t){return"ArrowUp"===t.key?(t.preventDefault(),void this.dropdown.selectIndex(-1)):"ArrowDown"===t.key?(t.preventDefault(),void this.dropdown.selectIndex(0)):void("Escape"===t.key&&(t.preventDefault(),this.dropdown.hide(),this.textInput.blur()))},e.prototype.handleInput=function(){var t,e=null!==(t=this.textInput.value)&&void 0!==t?t:"";if(this.currentTextValue===e||this.options.isMultiple||this.options.preserveId||this.changeHiddenInput(""),this.currentTextValue=e,!e)return this.clearSuggestions(),this.dropdown.hide(),void this.clearDataItem();this.getSuggestions(e)},e.prototype.handleSelectDropdownItem=function(t,e){this.options.isMultiple?e&&(this.tags.addTag(t),this.handleAddTag(t)):this.setDataItem(t,e)},e.prototype.handleFocusDropdownItem=function(t){this.options.isMultiple||this.setDataItem(t)},e.prototype.handleBlurDropdown=function(){this.focusInput()},e.prototype.handleAddTag=function(t){this.textInput.value="",this.currentTextValue="",this.currentDataItems.push(t),this.resetHiddenInputValue()},e.prototype.handleRemoveTag=function(t){var e,n=this.options.valueKey,r=u(t,n);this.currentDataItems=null===(e=this.currentDataItems)||void 0===e?void 0:e.filter((function(t){return u(t,n)!==r})),this.resetHiddenInputValue()},e.prototype.handleInsideClick=function(){this.isInnerClick=!0,this.options.isMultiple&&this.focusInput()},e.prototype.handleOutsideClick=function(){this.isInnerClick||this.dropdown.hide()&&(this.options.isMultiple||this.options.preserveId&&this.resetDataItem()),this.isInnerClick=!1},e.prototype.handleMutation=function(t){var e,n,r,o;"attributes"===t.type&&(this.isDisabled=this.textInput.disabled,this.isDisabled?(null===(e=this.dropdown)||void 0===e||e.disable(),null===(n=this.tags)||void 0===n||n.disable()):(null===(r=this.dropdown)||void 0===r||r.enable(),null===(o=this.tags)||void 0===o||o.enable()))},e.prototype.bind=function(){var t=this;this.hiddenInput.sfSetValue=this.setExternalValue,this.hiddenInput.sfSetDataItems=this.setDataItems,this.textInput.addEventListener("focus",this.handleFocus),this.textInput.addEventListener("blur",this.handleBlur),this.textInput.addEventListener("keydown",this.debouncedKeyDownListener),this.textInput.addEventListener("input",this.debouncedInputListener),this.node.addEventListener("click",this.handleInsideClick),document.addEventListener("click",this.handleOutsideClick),this.form=o.a.closest(this.node,"form"),this.form&&(this.resetListener=function(){t.currentTextValue="",t.clearDataItem()},this.form.addEventListener("reset",this.resetListener)),this.observer.observe(this.textInput,{attributes:!0})},e.prototype.die=function(){t.prototype.die.call(this),this.textInput.removeEventListener("focus",this.handleFocus),this.textInput.removeEventListener("blur",this.handleBlur),this.textInput.removeEventListener("keydown",this.debouncedKeyDownListener),this.textInput.removeEventListener("input",this.debouncedInputListener),this.node.removeEventListener("click",this.handleInsideClick),document.removeEventListener("click",this.handleOutsideClick),this.observer.disconnect(),this.form&&this.resetListener&&this.form.removeEventListener("reset",this.resetListener)},e.spiralFrameworkName="autocomplete",e.defaultOptions={preserveId:!1,id:"",name:"",valueKey:"id",searchKey:"name",separator:","},I([a],e.prototype,"handleSuccessDataSourceResponse",null),I([a],e.prototype,"handleErrorDataSourceResponse",null),I([a],e.prototype,"handleRestoreDataItem",null),I([a],e.prototype,"setDataItems",null),I([a],e.prototype,"setExternalValue",null),I([a],e.prototype,"handleFocus",null),I([a],e.prototype,"handleBlur",null),I([a],e.prototype,"handleKeyDown",null),I([a],e.prototype,"handleInput",null),I([a],e.prototype,"handleSelectDropdownItem",null),I([a],e.prototype,"handleFocusDropdownItem",null),I([a],e.prototype,"handleBlurDropdown",null),I([a],e.prototype,"handleAddTag",null),I([a],e.prototype,"handleRemoveTag",null),I([a],e.prototype,"handleInsideClick",null),I([a],e.prototype,"handleOutsideClick",null),I([a],e.prototype,"handleMutation",null),e}(o.a.core.BaseDOMConstructor);o.a.registerInstanceType(E,"js-sf-autocomplete");var O="Version 1.1.56, built at Thu Oct 29 2020 10:19:09 GMT+0300 (Moscow Standard Time)";e.default=E}])}));
//# sourceMappingURL=autocomplete.js.map